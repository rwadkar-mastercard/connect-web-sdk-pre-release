!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ConnectWebSDK=t():e.ConnectWebSDK=t()}(this,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Connect:()=>h});const o="connectIframe",n="connectStyles",r="window";let s,i,a,c,d,l,p,u;const f={onLoad:()=>{},onUser:e=>{},onRoute:e=>{}},h={destroy(){c&&c.parentNode&&c.parentNode.removeChild(c),d&&d.parentNode&&d.parentNode.removeChild(d),!c&&l&&l.close(),c=void 0,d=void 0,window.removeEventListener("message",i)},launch(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(a=e,s={...f,...t},p=new URL(a).origin,r.popup){const e={toolbar:"no",location:"no",status:"no",menubar:"no",width:720,height:520,top:window.self.outerHeight/2+window.self.screenY-360,left:window.self.outerWidth/2+window.self.screenX-260},t={...e,...r.popupOptions},o=window.open(a,"targetWindow","toolbar=".concat(e.toolbar,",location=").concat(e.location,",status=").concat(e.status,",menubar=").concat(e.menubar,",width=").concat(t.width,",height=").concat(t.height,",top=").concat(t.top,",left=").concat(t.left));return o?(l=o,o.focus(),this.initPostMessage(r),s.onLoad&&s.onLoad()):s.onError({reason:"error",code:1403}),o}if(c&&c.parentNode)throw new Error('You must destroy the iframe before you can open a new one. Call "destroy()"');if(!document.getElementById(n)){const e=document.createElement("style");e.id=n,e.type="text/css",e.innerHTML="#".concat(o," {\n          position: absolute;\n          left: 0;\n          top: 0;\n          width: 100%;\n          height: 100%;\n          z-index: 10;\n          background: rgba(0,0,0,0.8);\n        }"),document.getElementsByTagName("head")[0].appendChild(e)}if(0===document.querySelectorAll('meta[name="viewport"]').length&&(d=document.createElement("meta"),d.setAttribute("name","viewport"),d.setAttribute("content","initial-scale=1"),document.head.appendChild(d)),c=document.createElement("iframe"),c.src=a,c.setAttribute("id",o),c.setAttribute("frameborder","0"),c.setAttribute("scrolling","no"),c.setAttribute("aria-label","Launching Modal"),c.setAttribute("title","Launching Modal"),r.overlay&&c.setAttribute("style","background: ".concat(r.overlay,";")),r.node)r.node.appendChild(c);else{const e=r.selector?document.querySelector(r.selector):document.body;e?e.appendChild(c):(console.warn("Couldn't find any elements matching \"".concat(r.selector,'", appending "iframe" to "body" instead.')),document.body.appendChild(c))}return c.onload=()=>{l=c.contentWindow,this.initPostMessage(r),s.onLoad&&s.onLoad()},null},initPostMessage(e){const t=setInterval((()=>{const t={type:"ping",selector:e.selector,sdkVersion:"PACKAGE_VERSION",platform:"".concat(e.popup?"web":"iframe")};e.redirectUrl&&(t.redirectUrl=e.redirectUrl),this.postMessage(t)}),1e3);i=o=>{const n=o.data.data,r=o.data.type;if(o.origin===p)if("ack"!==r||e.popup){if("url"===r)this.openPopupWindow(o.data.url);else if("done"===r)s.onDone(n),this.destroy();else if("cancel"===r)s.onCancel(n),this.destroy();else if("error"===r)s.onError(n),this.destroy();else if("route"===r)s.onRoute&&s.onRoute(n);else if("user"===r)s.onUser&&s.onUser(n);else if("closePopup"===r){var i;null===(i=u)||void 0===i||i.close()}}else clearInterval(t)},window.addEventListener("message",i)},openPopupWindow(e){const t=window.self.outerHeight/2+window.self.screenY-300,o=window.self.outerWidth/2+window.self.screenX-300;if(u=window.open(e,"targetWindow","toolbar=no,location=no,status=no,menubar=no,width=".concat(600,",height=").concat(600,",top=").concat(t,",left=").concat(o)),u){u.focus();const e=setInterval((()=>{var t;null!==(t=u)&&void 0!==t&&t.closed&&(clearInterval(e),this.postMessage({type:r,closed:!0,blocked:!1}))}),1e3)}else this.postMessage({type:r,closed:!0,blocked:!0})},postMessage(e){var t;null===(t=l)||void 0===t||t.postMessage(e,a)}};return t})()));
"use strict";var u=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames,m=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var v=(t,o,e)=>o in t?u(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,d=(t,o)=>{for(var e in o||(o={}))N.call(o,e)&&v(t,e,o[e]);if(m)for(var e of m(o))$.call(o,e)&&v(t,e,o[e]);return t};var F=(t,o)=>{for(var e in o)u(t,e,{get:o[e],enumerable:!0})},k=(t,o,e,s)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of W(o))!N.call(t,n)&&n!==e&&u(t,n,{get:()=>o[n],enumerable:!(s=S(o,n))||s.enumerable});return t};var G=t=>k(u({},"__esModule",{value:!0}),t);var q={};F(q,{Connect:()=>Y});module.exports=G(q);var f="connectIframe",g="connectStyles",h="iframe",O="web",_="PACKAGE_VERSION";var w="ack",T="cancel",y="url",b="done",I="error",R="ping",C="window",x="route",U="user",A="closePopup";var i,P,p,r,a,c,D,l,K={onLoad:()=>{},onUser:t=>{},onRoute:t=>{}},Y={destroy(){r&&r.parentNode&&r.parentNode.removeChild(r),a&&a.parentNode&&a.parentNode.removeChild(a),!r&&c&&c.close(),r=void 0,a=void 0,window.removeEventListener("message",P)},launch(t,o,e={}){if(p=t,i=d(d({},K),o),D=new URL(p).origin,e.popup){let s={toolbar:"no",location:"no",status:"no",menubar:"no",width:720,height:520,top:window.self.outerHeight/2+window.self.screenY-720/2,left:window.self.outerWidth/2+window.self.screenX-520/2},n=d(d({},s),e.popupOptions),E=window.open(p,"targetWindow",`toolbar=${s.toolbar},location=${s.location},status=${s.status},menubar=${s.menubar},width=${n.width},height=${n.height},top=${n.top},left=${n.left}`);return E?(c=E,E.focus(),this.initPostMessage(e),i.onLoad&&i.onLoad()):i.onError({reason:"error",code:1403}),E}else{if(r&&r.parentNode)throw new Error('You must destroy the iframe before you can open a new one. Call "destroy()"');if(!document.getElementById(g)){let n=document.createElement("style");n.id=g,n.type="text/css",n.innerHTML=`#${f} {
          position: absolute;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          z-index: 10;
          background: rgba(0,0,0,0.8);
        }`,document.getElementsByTagName("head")[0].appendChild(n)}if(document.querySelectorAll('meta[name="viewport"]').length===0&&(a=document.createElement("meta"),a.setAttribute("name","viewport"),a.setAttribute("content","initial-scale=1"),document.head.appendChild(a)),r=document.createElement("iframe"),r.src=p,r.setAttribute("id",f),r.setAttribute("frameborder","0"),r.setAttribute("scrolling","no"),r.setAttribute("aria-label","Launching Modal"),r.setAttribute("title","Launching Modal"),e.overlay&&r.setAttribute("style",`background: ${e.overlay};`),e.node)e.node.appendChild(r);else{let n=e.selector?document.querySelector(e.selector):document.body;n?n.appendChild(r):(console.warn(`Couldn't find any elements matching "${e.selector}", appending "iframe" to "body" instead.`),document.body.appendChild(r))}return r.onload=()=>{c=r.contentWindow,this.initPostMessage(e),i.onLoad&&i.onLoad()},null}},initPostMessage(t){let o=setInterval(()=>{let e={type:R,selector:t.selector,sdkVersion:_,platform:`${t.popup?O:h}`};t.redirectUrl&&(e.redirectUrl=t.redirectUrl),this.postMessage(e)},1e3);P=e=>{let s=e.data.data,n=e.data.type;e.origin===D&&(n===w&&!t.popup?clearInterval(o):n===y?this.openPopupWindow(e.data.url):n===b?(i.onDone(s),this.destroy()):n===T?(i.onCancel(s),this.destroy()):n===I?(i.onError(s),this.destroy()):n===x?i.onRoute&&i.onRoute(s):n===U?i.onUser&&i.onUser(s):n===A&&(l==null||l.close()))},window.addEventListener("message",P)},openPopupWindow(t){let o=window.self.outerHeight/2+window.self.screenY-600/2,e=window.self.outerWidth/2+window.self.screenX-600/2;if(l=window.open(t,"targetWindow",`toolbar=no,location=no,status=no,menubar=no,width=${600},height=${600},top=${o},left=${e}`),l){l.focus();let s=setInterval(()=>{l!=null&&l.closed&&(clearInterval(s),this.postMessage({type:C,closed:!0,blocked:!1}))},1e3)}else this.postMessage({type:C,closed:!0,blocked:!0})},postMessage(t){c==null||c.postMessage(t,p)}};0&&(module.exports={Connect});
//# sourceMappingURL=index.min.js.map
